<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>GSN</title>
        
        <link rel="stylesheet" href="style/gsn.css" type="text/css" media="screen,projection" />
        <script type="text/javascript" src="js/jquery-1.6.1.min.js"></script>
        <script type="text/javascript" src="js/jquery-dom.js"></script>
        <script type="text/javascript" src="js/jquery.history.js"></script>
        <script type="text/javascript" src="js/jquery.cookie.js"></script>
        <script type="text/javascript" src="js/uptime.js"></script>

        <!-- Visualization -->
        <link rel="stylesheet" type="text/css" href="http://whymper.ethz.ch:24001/sensorviz.css" />
        <link rel="stylesheet" type="text/css" href="style/jquery-ui-1.8.13.custom.css" />
        <!--[if IE]><script src="http://whymper.ethz.ch:24001/excanvas.js"></script><![endif]-->
        <script type='text/javascript' src='js/jquery-ui-1.8.13.min.js'></script>
        <script type='text/javascript' src='http://whymper.ethz.ch:24001/dygraph-combined.js'></script>
        <script type='text/javascript' src='http://whymper.ethz.ch:24001/sensorviz.js'></script>
        <script type='text/javascript' src='js/gsnplots.js'></script>

<script type="text/javascript">
<!--//<![CDATA[

// OpenSense plots
var nabelDueConfig
var nabelZueConfig
var ozoneDueConfig
var ozoneZueConfig
                                                                                                     
$(document).ready(function() {
    $.get('/menu.jsp', {selected: "science"}, function(data) {
      $('#navigation').html(data);
    }, 'html');
    $("#navigation ul a.local").bind("click",function() { return GSN.nav($(this).text()); });

    // plot configuration
    GsnPlots.setConfig([
      // test
      {"vsensor":"dozer_th3temp__conv",
       "field":["temperature_5cm","temperature_10cm","temperature_20cm","temperature_30cm","temperature_50cm","temperature_100cm"],
       "title":"Temperatures",
       "select":"sensornode[position=6]"},
      // matterhorn
      {"vsensor":"sensorrod1",
       "field":["sr_t1","sr_t2","sr_t3","sr_t4"],
       "title":"Sensorrod Temperatures",
       "select":"sensornode[position=10]"},
      {"vsensor":"crackmeter__ccnn",
       "field":["ccnn_dx0"],
       "title":"Crackmeter",
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=22]"},
      {"vsensor":"crackmeter__ccnn",
       "field":["ccnn_dx1"],
       "title":"Crackmeter",
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=22]"},
      {"vsensor":"crackmeter__ccct",
       "field":["ccct_dx0"],
       "title":"Crackmeter",
       "select":"sensornode[position=9]"},
      {"vsensor":"crackmeter__ccct",
       "field":["ccct_dx2"],
       "title":"Crackmeter",
       "select":"sensornode[position=9]"},
      {"vsensor":"crackmeter__ctct",
       "field":["ctct_dx1"],
       "title":"Crackmeter",
       "select":"sensornode[position=6]"},
      {"vsensor":"crackmeter__ctct",
       "field":["ctct_dx2"],
       "title":"Crackmeter",
       "select":"sensornode[position=6]"},
      {"vsensor":"crackmeter__nctt",
       "field":["nctt_dx1"],
       "title":"Crackmeter",
       "select":"sensornode[position=1],sensornode[position=2],sensornode[position=3],sensornode[position=4]"},
      {"vsensor":"crackmeter__nctc",
       "field":["nctc_dx1"],
       "title":"Crackmeter Position 8",
       "select":"sensornode[position=8]"},
      {"vsensor":"crackmeter__nctc",
       "field":["nctc_dx2"],
       "title":"Crackmeter Position 8",
       "select":"sensornode[position=8]"},
      {"vsensor":"crackmeter__nctt",
       "field":["nctt_dx1", "nctt_t1", "nctt_t2",],
       "title":"Crackmeter Temperature Position 2",
       "select":"sensornode[position=2]"},


      // thur
      {"vsensor":"dozer_decagonmux__conv",
       "field":["conductivity0","conductivity1","conductivity2","conductivity3","conductivity4",], 
       "title":"Decagon Conductivity", 
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=1],"},
      {"vsensor":"dozer_decagonmux__conv",
       "field":["conductivity0","conductivity1","conductivity2","conductivity3","conductivity4",], 
       "title":"Decagon Conductivity", 
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=2],"},
      {"vsensor":"dozer_decagonmux__conv",
       "field":["conductivity0","conductivity1","conductivity2","conductivity3","conductivity4",], 
       "title":"Decagon Conductivity", 
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=3],"},
      {"vsensor":"dozer_decagonmux__conv",
       "field":["conductivity0","conductivity1","conductivity2","conductivity3","conductivity4",], 
       "title":"Decagon Conductivity", 
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=4],"},
      {"vsensor":"dozer_decagonmux__conv",
       "field":["conductivity0","conductivity1","conductivity2","conductivity3","conductivity4",], 
       "title":"Decagon Conductivity", 
       "select":"sensornode[position=20],sensornode[position=21],sensornode[position=5],"},

    ]);

    $.ajax({
      type: "GET",
      url: "/gsn?structure",
      success: function(data){
        if ($(document).attr("title")=="GSN") {
          var gsn = $("gsn",data);
          $(document).attr("title",$(gsn).attr("name"));
          $("#gsn-name").empty().append($(gsn).attr("name"));
          $("#gsn-desc").empty().append($(gsn).attr("description"));
          $("#gsn-author").empty().append($(gsn).attr("author")+" ("+$(gsn).attr("email")+")");
          var gsnname = $(gsn).attr("name").replace(/.*::\s*GSN\s*-\s*/, "").replace(/\s/g,"").toLowerCase();
          $('head', document).append('<link rel="shortcut icon" href="/img/favicon/permasense-'+gsnname+'.ico"><link rel="icon" href="/img/favicon/permasense-'+gsnname+'.ico">');
        }
        $("#gsn-name").show();
        uptime.setTime($(gsn).attr("uptime"));
        GsnPlots.initPlots(data, function(){addDeployments();});
      }
    });
});

function addDeployments() {
  // add deployment tabs and container
  var visible=-1;
  var d = GsnPlots.getDeployments();
  $(d).each(function() {
    if ($.cookie("deployment")==this)
      visible = this;
  });
  if (visible==-1) {
      visible = d[0];
  }
  $(d).each(function() {
    $('#deployment_menu').append('<li><a href="javascript:showPlots(\''+this+'\')" id="deployment_menu_item_'+this+'">'+this+'</a></li>');
    $('#plotscontainer').append('<div id="plot_'+this+'"></div>');
    $('#plot_'+this).hide();
    if (this == "Ostest" || this == "Opensense") {
        initOpenSensePlots(this);
    }
  });

  showPlots(visible);
}

function showPlots(id) {
  $(GsnPlots.getDeployments()).each(function() {
      $("#plot_"+this).empty().hide();
      $("#deployment_menu_item_"+this).removeClass("selected");
  });
  $("#plot_"+id).show();
  $("#deployment_menu_item_"+id).addClass("selected");
  // add graphs
  if (id == "Ostest" || id == "Opensense") {
      var divid = 0;

      $('#plot_'+id).append('<div><h2>'+ozoneDueConfig.graph.title+'</h2><div id="plot_'+divid+'"/></div>');
      ozoneDueConfig.graph.div = 'plot_' + divid++;
      var g3 = new FrontendCreator(ozoneDueConfig);

      $('#plot_'+id).append('<div><h2>'+ozoneZueConfig.graph.title+'</h2><div id="plot_'+divid+'"/></div>');
      ozoneZueConfig.graph.div = 'plot_' + divid++;
      var g4 = new FrontendCreator(ozoneZueConfig);
      
      $('#plot_'+id).append('<div><h2>'+nabelDueConfig.graph.title+'</h2><div id="plot_'+divid+'"/></div>');
      nabelDueConfig.graph.div = 'plot_' + divid++;
      var g1 = new FrontendCreator(nabelDueConfig);

      $('#plot_'+id).append('<div><h2>'+nabelZueConfig.graph.title+'</h2><div id="plot_'+divid+'"/></div>');
      nabelZueConfig.graph.div = 'plot_' + divid++;
      var g2 = new FrontendCreator(nabelZueConfig);


  }
  else {
      GsnPlots.addPlots($("#plot_"+id), id)
  }
  $.cookie("deployment" , id);
  
}

function initOpenSensePlots(id) {

  nabelDueConfig = {                                                                                                     
        "graph": {                                                                                                       
	"div": "",                                                                                             
	"type": "dygraph",                                                                                           
	"width": 800,                                                                                                
	"height": 350,
	"showForm": true,                                                                                             
	"title": "Air Pollution NABEL Duebendorf"
    },
    "appUrl": "http://whymper.ethz.ch:24001/sensorviz?",                                                             

    "signals": {                                                                                                     
	"y1": [                                                                                                      
	{
	    "displayName": "O3 (PPB)",                                                   
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_duebendorf__mapped",                                                      
	    "field": "ozone_ppb",
	    "deviceId": 100,                                                                                         
	    "scaling": 1.0,
	    "visible": true,                                                                                         
	    "timeline":"generation_time"                                                                             
	},
	{                                                                                                            
	    "displayName": "CO (PPM)",                                                      
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_duebendorf__mapped",                                                      
	    "field": "co_ppm",                                                                                       
	    "deviceId": 100,
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"
	},                                                                                                           
	{
	    "displayName": "NO2 (PPB)",                                                     
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_duebendorf__mapped",                                                      
	    "field": "no2_ppb",                                                                                      
	    "deviceId": 100,                                                                                         
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"                                                                             
	}                                                                                                            
	]                                                                                                            
    }                                                                                                                
  };

  nabelZueConfig = {                                                                                                     
        "graph": {                                                                                                       
	"div": "",                                                                                             
	"type": "dygraph",                                                                                           
	"width": 800,                                                                                                
	"height": 350,
	"showForm": true,                                                                                             
	"title": "Air Pollution NABEL Zuerich"
    },
    "appUrl": "http://whymper.ethz.ch:24001/sensorviz?",                                                             

    "signals": {                                                                                                     
	"y1": [                                                                                                      
	{
	    "displayName": "O3 (PPB)",                                                   
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_zuerich__mapped",                                                      
	    "field": "ozone_ppb",
	    "deviceId": 100,                                                                                         
	    "scaling": 1.0,
	    "visible": true,                                                                                         
	    "timeline":"generation_time"                                                                             
	},
	{                                                                                                            
	    "displayName": "CO (PPM)",                                                      
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_zuerich__mapped",                                                      
	    "field": "co_ppm",                                                                                       
	    "deviceId": 100,
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"
	},                                                                                                           
	{
	    "displayName": "NO2 (PPB)",                                                     
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_zuerich__mapped",                                                      
	    "field": "no2_ppb",                                                                                      
	    "deviceId": 100,                                                                                         
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"                                                                             
	}                                                                                                            
	]                                                                                                            
    }                                                                                                                
  };

  ozoneDueConfig = {                                                                                                     
        "graph": {                                                                                                       
	"div": "",                                                                                             
	"type": "dygraph",                                                                                           
	"width": 800,                                                                                                
	"height": 350,
	"showForm": true,                                                                                             
	"title": "Ozone Concentration Duebendorf: NABEL vs. Gas Sensor"
    },
    "appUrl": "http://whymper.ethz.ch:24001/sensorviz?",                                                             

    "signals": {                                                                                                     
	"y1": [                                                                                                      
	{
	    "displayName": "NABEL (PPB)",                                                   
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_duebendorf__mapped",                                                      
	    "field": "ozone_ppb",
	    "deviceId": 100,                                                                                         
	    "scaling": 1.0,
	    "visible": true,                                                                                         
	    "timeline":"generation_time"                                                                             
	},
	{                                                                                                            
	    "displayName": "Sensor Factory Cal. (PPB)",                                                      
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_oz47_dynamic__mapped",                                                      
	    "field": "ozone_sensor_1",                                                                                       
	    "deviceId": 1,
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"
	},
        {                                                                                                            
	    "displayName": "Sensor Instant Cal. (PPB)",                                                      
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_oz47_concentration",                                                      
	    "field": "ozone_ppb",                                                                                       
	    "deviceId": 1,
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"
	}                                                                                                           
	]                                                                                                            
    }                                                                                                                
  };

  ozoneZueConfig = {                                                                                                     
        "graph": {                                                                                                       
	"div": "",                                                                                             
	"type": "dygraph",                                                                                           
	"width": 800,                                                                                                
	"height": 350,
	"showForm": true,                                                                                             
	"title": "Ozone Concentration Zuerich: NABEL vs. Gas Sensor"
    },
    "appUrl": "http://whymper.ethz.ch:24001/sensorviz?",                                                             

    "signals": {                                                                                                     
	"y1": [                                                                                                      
	{
	    "displayName": "NABEL (PPB)",                                                   
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_nabel_zuerich__mapped",                                                      
	    "field": "ozone_ppb",
	    "deviceId": 100,                                                                                         
	    "scaling": 1.0,
	    "visible": true,                                                                                         
	    "timeline":"generation_time"                                                                             
	},
	{                                                                                                            
	    "displayName": "Sensor Factory Cal. (PPB)",                                                      
	    "gsnUrl": "tik51x:22001",                                                                                
	    "virtualSensor": id.toLowerCase()+"_oz47_dynamic__mapped",                                                      
	    "field": "ozone_sensor_1",                                                                                       
	    "deviceId": 3,
	    "scaling": 1.0,                                                                                          
	    "visible": false,                                                                                        
	    "timeline":"generation_time"
	}
	]                                                                                                            
    }                                                                                                                
  };
}
	
//]]>-->
</script>
</head>
<body>

<div id="container">
	<div id="header">
		<h1><a href="." id="gsn-name" style="display:none">GSN</a></h1>
	</div>
	<div id="navigation">
	</div>
	
	<div id="separator">
		<div id="starttext">
			<p>
				A collection of scientific plots related to the PermaSense Deployments.
			</p>
		</div>
	</div>

	<div id="maindiv">
		<div id="deployment_navigation">
		<ul id="deployment_menu">
		<li />
		</ul>
		</div>	
		
		<div id="plotscontainer" style="margin-top:5px"></div>
		
	</div>
	<div class="separator">
		<div id="footer">
		      <table width="100%">
				<tr>
					<td style="width:50%;color:#444444;"><b>A Project of <a href="http://www.ethz.ch" target="_blank">ETH Zurich</a>, <a href="http://www.unibas.ch" target="_blank">Uni Basel</a> and <a href="http://www.uzh.ch" target="_blank">Uni Zurich</a></b></td>
					<td style="text-align:right;width:50%;font-size:9px;">Powered by <a href="http://gsn.sourceforge.net/">GSN</a>,  Distributed Information Systems Lab, EPFL 2006</td>
				</tr>
			</table>
		</div>
	</div>
</div>
<!-- script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5632004-2");
pageTracker._initData();
pageTracker._trackPageview();
</script -->
</body>
</html>
