\usepackage{lastpage}
%
\usepackage{fancyhdr} 
%
%\usepackage{sfheaders} % set headers(sections, chapters, ... to sans sherif font)
%
\usepackage{amsmath}
%
\usepackage{draftcopy}
%
\usepackage{color}
%
\usepackage{listings}
%
\usepackage{graphicx}
%
\usepackage{tabulary}
\setlength{\tymin}{10pt}
\setlength{\tymax}{0.5\textwidth}
%


% Custom fonts -> uncomment and compile with XeLaTeX instead of LaTeX
%\usepackage{fontspec,xunicode}
%\defaultfontfeatures{Mapping=tex-text}
%\setsansfont[Scale=1]{Myriad Pro Light}
%\setromanfont[Scale=1.10]{LMRoman9 Regular}
%\setmonofont[Scale=1]{LMTypewriter10 Regular}

% Figures: path x width x angle x description x label
% eg. \image{image.pdf}{0.8}{0}{Global Sensor Network software architecture}{figure:gsn_architecture}
\newcommand{\image}[5]{
  \begin{figure} [!htp]
    \begin{center}
       \includegraphics[angle=#3, width=#2\textwidth]{#1}
       \caption{\label{#5} #4}
     \end{center}
  \end{figure}
}

% References
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\chapref}[1]{Chapter~\ref{#1}}
\newcommand{\annexeref}[1]{Appendix~\ref{#1}}
\newcommand{\tableref}[1]{Table~\ref{#1}}
\newcommand{\listingref}[1]{Listing~\ref{#1}}

% Listings
\definecolor{l_keyword}{rgb}{0.49,0,0.33} 
\definecolor{l_comment}{rgb}{0.49,0.62,0.75} 
\definecolor{l_string}{rgb}{0.16,0,1} 
\lstloadlanguages{Ruby,Java,XML,HTML}
% Default Settings
\lstset{
	basicstyle=\fontfamily{pcr}\fontseries{m}\fontshape{n}\small, % pcr | cmss
	keywordstyle=\color{l_keyword},
	commentstyle=\color{l_comment},
	stringstyle=\color{l_string},
	tagstyle=\color{black},
	tabsize=3,
	showstringspaces=false,
	captionpos=b,
	frame=none, %none, leftline, topline, bottomline, lines, single
	%numbers=left,
	%numberstyle=\fontfamily{pcr}\fontseries{m}\fontshape{n}\scriptsize,
	%numbersep=5pt,
	%stepnumber=1
}
% Per language Settings
\lstnewenvironment{rubycode}[1][]
	{\lstset{language=Ruby, #1}}
	{}
\lstnewenvironment{javacode}[1][]
	{\lstset{language=Java, #1}}
	{}
\lstnewenvironment{xmlcode}[1][]
	{\lstset{language=XML, #1}}
	{}
\lstnewenvironment{htmlcode}[1][]
	{\lstset{language=HTML, #1}}
	{}
\lstnewenvironment{bashcode}[1][]
	{\lstset{language=bash, #1}}
	{}

% Layout
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\nouppercase{\rightmark}}
\fancyhead[R]{\rule[-5pt]{0.5pt}{16pt}\makebox[21.3pt]{\thepage}}
\fancyfoot[L,R]{}
\renewcommand{\headrulewidth}{0.5pt}
\addtolength{\headheight}{4pt}
\addtolength{\voffset}{-15pt}
\addtolength{\textheight}{30pt}
\addtolength{\headwidth}{65pt}
\addtolength{\textwidth}{65pt}
\addtolength{\oddsidemargin}{-25pt}
\addtolength{\evensidemargin}{-55pt}
%
\fancypagestyle{plain}{ 
	\fancyhead[L,R]{}
	\fancyhead[L]{}
	\fancyfoot[R]{\thepage}
	\renewcommand{\headrulewidth}{0pt}
}
% 
\newcommand{\clearemptydoublepage}{\newpage{\pagestyle{plain}\cleardoublepage}}
%
\sloppy
\setlength{\parskip}{0.5\baselineskip} 

% Misc
\newcommand{\todo}[1]{\textcolor{red}{#1}}
